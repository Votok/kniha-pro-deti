{# Schema.org JSON-LD pro detail knihy #}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Book",
  "name": "{{ book.title }}",
  "description": "{{ book.description | replace('"', '\\"') }}",
  "url": "{{ site.url }}/{{ book.slug }}.html",
  "author": [
    {% for author in book.authors.text %}
    { "@type": "Person", "name": "{{ author }}" }{% if not loop.last %},{% endif %}
    {% endfor %}
  ],
  {% if book.authors.illustrations and book.authors.illustrations.length > 0 %}
  "illustrator": [
    {% for illustrator in book.authors.illustrations %}
    { "@type": "Person", "name": "{{ illustrator }}" }{% if not loop.last %},{% endif %}
    {% endfor %}
  ],
  {% endif %}
  "datePublished": "{{ book.publishedDate }}",
  "publisher": {
    "@type": "Organization",
    "name": "{{ book.publisher }}"
  },
  "bookFormat": "Hardcover",
  "inLanguage": "cs",
  "typicalAgeRange": "{{ book.ageGroup | replace('Pro děti od ', '') | replace(' do ', '-') | replace(' let', '') }}",
  {% if book.pages %}"numberOfPages": {{ book.pages }},{% endif %}
  "image": "{{ site.url }}/{{ book.cover }}"{% if book.isbn %},
  "isbn": "{{ book.isbn }}"{% endif %}{% if book.buyLinks and book.buyLinks.length > 0 %},
  "offers": [
    {% for link in book.buyLinks %}
    {
      "@type": "Offer",
      "url": "{{ link.url }}",
      "availability": "https://schema.org/InStock",
      "seller": {
        "@type": "Organization",
        "name": "{{ link.retailer }}"
      }
    }{% if not loop.last %},{% endif %}
    {% endfor %}
  ]{% endif %}
}
</script>

{# BreadcrumbList JSON-LD #}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Úvod",
      "item": "{{ site.url }}/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Knihy",
      "item": "{{ site.url }}/#knihy"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "{{ book.title }}",
      "item": "{{ site.url }}/{{ book.slug }}.html"
    }
  ]
}
</script>

{# BookSeries JSON-LD — propojení knih v sérii #}
{% if book.series %}
{% set seriesBooks = books | selectattr("series", "equalto", book.series) %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BookSeries",
  "name": "Série {{ book.series }}",
  "url": "{{ site.url }}/#knihy",
  "hasPart": [
    {% for b in seriesBooks %}
    {
      "@type": "Book",
      "name": "{{ b.title }}",
      "url": "{{ site.url }}/{{ b.slug }}.html"
    }{% if not loop.last %},{% endif %}
    {% endfor %}
  ]
}
</script>
{% endif %}
